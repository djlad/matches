(this.webpackJsonpmatches=this.webpackJsonpmatches||[]).push([[0],Array(39).concat([function(t,e,s){t.exports=s.p+"static/media/back.3b7119c9.svg"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,s){t.exports=s(270)},,,,,function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){var a={"./10_of_clubs.svg":90,"./10_of_diamonds.svg":91,"./10_of_hearts.svg":92,"./10_of_spades.svg":93,"./2_of_clubs.svg":94,"./2_of_diamonds.svg":95,"./2_of_hearts.svg":96,"./2_of_spades.svg":97,"./3_of_clubs.svg":98,"./3_of_diamonds.svg":99,"./3_of_hearts.svg":100,"./3_of_spades.svg":101,"./4_of_clubs.svg":102,"./4_of_diamonds.svg":103,"./4_of_hearts.svg":104,"./4_of_spades.svg":105,"./5_of_clubs.svg":106,"./5_of_diamonds.svg":107,"./5_of_hearts.svg":108,"./5_of_spades.svg":109,"./6_of_clubs.svg":110,"./6_of_diamonds.svg":111,"./6_of_hearts.svg":112,"./6_of_spades.svg":113,"./7_of_clubs.svg":114,"./7_of_diamonds.svg":115,"./7_of_hearts.svg":116,"./7_of_spades.svg":117,"./8_of_clubs.svg":118,"./8_of_diamonds.svg":119,"./8_of_hearts.svg":120,"./8_of_spades.svg":121,"./9_of_clubs.svg":122,"./9_of_diamonds.svg":123,"./9_of_hearts.svg":124,"./9_of_spades.svg":125,"./ace_of_clubs.svg":126,"./ace_of_diamonds.svg":127,"./ace_of_hearts.svg":128,"./ace_of_spades.svg":129,"./ace_of_spades2.svg":130,"./back.svg":39,"./black_joker.svg":131,"./jack_of_clubs.svg":132,"./jack_of_clubs2.svg":133,"./jack_of_diamonds.svg":134,"./jack_of_diamonds2.svg":135,"./jack_of_hearts.svg":136,"./jack_of_hearts2.svg":137,"./jack_of_spades.svg":138,"./jack_of_spades2.svg":139,"./king_of_clubs.svg":140,"./king_of_clubs2.svg":141,"./king_of_diamonds.svg":142,"./king_of_diamonds2.svg":143,"./king_of_hearts.svg":144,"./king_of_hearts2.svg":145,"./king_of_spades.svg":146,"./king_of_spades2.svg":147,"./queen_of_clubs.svg":148,"./queen_of_clubs2.svg":149,"./queen_of_diamonds.svg":150,"./queen_of_diamonds2.svg":151,"./queen_of_hearts.svg":152,"./queen_of_hearts2.svg":153,"./queen_of_spades.svg":154,"./queen_of_spades2.svg":155,"./red_joker.svg":156};function i(t){var e=n(t);return s(e)}function n(t){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=n,t.exports=i,i.id=89},function(t,e,s){t.exports=s.p+"static/media/10_of_clubs.669c20fc.svg"},function(t,e,s){t.exports=s.p+"static/media/10_of_diamonds.dbb3850c.svg"},function(t,e,s){t.exports=s.p+"static/media/10_of_hearts.c6339410.svg"},function(t,e,s){t.exports=s.p+"static/media/10_of_spades.3963b09b.svg"},function(t,e,s){t.exports=s.p+"static/media/2_of_clubs.94b4a5b0.svg"},function(t,e,s){t.exports=s.p+"static/media/2_of_diamonds.eaef1133.svg"},function(t,e,s){t.exports=s.p+"static/media/2_of_hearts.1b2188a0.svg"},function(t,e,s){t.exports=s.p+"static/media/2_of_spades.b821dcd9.svg"},function(t,e,s){t.exports=s.p+"static/media/3_of_clubs.4281c3d1.svg"},function(t,e,s){t.exports=s.p+"static/media/3_of_diamonds.b9d5e12f.svg"},function(t,e,s){t.exports=s.p+"static/media/3_of_hearts.dfb7b9c5.svg"},function(t,e,s){t.exports=s.p+"static/media/3_of_spades.471f3e59.svg"},function(t,e,s){t.exports=s.p+"static/media/4_of_clubs.037d8c23.svg"},function(t,e,s){t.exports=s.p+"static/media/4_of_diamonds.72d20001.svg"},function(t,e,s){t.exports=s.p+"static/media/4_of_hearts.6369d1c9.svg"},function(t,e,s){t.exports=s.p+"static/media/4_of_spades.e1ae3152.svg"},function(t,e,s){t.exports=s.p+"static/media/5_of_clubs.12408f64.svg"},function(t,e,s){t.exports=s.p+"static/media/5_of_diamonds.eda01110.svg"},function(t,e,s){t.exports=s.p+"static/media/5_of_hearts.3a5059d0.svg"},function(t,e,s){t.exports=s.p+"static/media/5_of_spades.8f300fb5.svg"},function(t,e,s){t.exports=s.p+"static/media/6_of_clubs.3708c7e5.svg"},function(t,e,s){t.exports=s.p+"static/media/6_of_diamonds.a8aabd2d.svg"},function(t,e,s){t.exports=s.p+"static/media/6_of_hearts.13bea5a1.svg"},function(t,e,s){t.exports=s.p+"static/media/6_of_spades.dd29ca5a.svg"},function(t,e,s){t.exports=s.p+"static/media/7_of_clubs.768d16ac.svg"},function(t,e,s){t.exports=s.p+"static/media/7_of_diamonds.d00ed5bc.svg"},function(t,e,s){t.exports=s.p+"static/media/7_of_hearts.51aa35bf.svg"},function(t,e,s){t.exports=s.p+"static/media/7_of_spades.00b5eed0.svg"},function(t,e,s){t.exports=s.p+"static/media/8_of_clubs.55a0952d.svg"},function(t,e,s){t.exports=s.p+"static/media/8_of_diamonds.5f81e325.svg"},function(t,e,s){t.exports=s.p+"static/media/8_of_hearts.f6325833.svg"},function(t,e,s){t.exports=s.p+"static/media/8_of_spades.4ff481d5.svg"},function(t,e,s){t.exports=s.p+"static/media/9_of_clubs.cf6317bc.svg"},function(t,e,s){t.exports=s.p+"static/media/9_of_diamonds.a578d7b2.svg"},function(t,e,s){t.exports=s.p+"static/media/9_of_hearts.71f25336.svg"},function(t,e,s){t.exports=s.p+"static/media/9_of_spades.46304258.svg"},function(t,e,s){t.exports=s.p+"static/media/ace_of_clubs.9ee19a01.svg"},function(t,e,s){t.exports=s.p+"static/media/ace_of_diamonds.dd4d7167.svg"},function(t,e,s){t.exports=s.p+"static/media/ace_of_hearts.47428313.svg"},function(t,e,s){t.exports=s.p+"static/media/ace_of_spades.b9f81c2d.svg"},function(t,e,s){t.exports=s.p+"static/media/ace_of_spades2.223cd5d8.svg"},function(t,e,s){t.exports=s.p+"static/media/black_joker.7ce690e9.svg"},function(t,e,s){t.exports=s.p+"static/media/jack_of_clubs.b02355d1.svg"},function(t,e,s){t.exports=s.p+"static/media/jack_of_clubs2.56c4541c.svg"},function(t,e,s){t.exports=s.p+"static/media/jack_of_diamonds.856386ef.svg"},function(t,e,s){t.exports=s.p+"static/media/jack_of_diamonds2.c38f31dc.svg"},function(t,e,s){t.exports=s.p+"static/media/jack_of_hearts.252a0b89.svg"},function(t,e,s){t.exports=s.p+"static/media/jack_of_hearts2.02d4f21b.svg"},function(t,e,s){t.exports=s.p+"static/media/jack_of_spades.91a4ffb4.svg"},function(t,e,s){t.exports=s.p+"static/media/jack_of_spades2.a1f0114e.svg"},function(t,e,s){t.exports=s.p+"static/media/king_of_clubs.e94802c7.svg"},function(t,e,s){t.exports=s.p+"static/media/king_of_clubs2.ff456a80.svg"},function(t,e,s){t.exports=s.p+"static/media/king_of_diamonds.9f9f91e2.svg"},function(t,e,s){t.exports=s.p+"static/media/king_of_diamonds2.658998b1.svg"},function(t,e,s){t.exports=s.p+"static/media/king_of_hearts.0f60db3e.svg"},function(t,e,s){t.exports=s.p+"static/media/king_of_hearts2.09112d05.svg"},function(t,e,s){t.exports=s.p+"static/media/king_of_spades.68cb8d2e.svg"},function(t,e,s){t.exports=s.p+"static/media/king_of_spades2.fe66fe03.svg"},function(t,e,s){t.exports=s.p+"static/media/queen_of_clubs.fc3e13ab.svg"},function(t,e,s){t.exports=s.p+"static/media/queen_of_clubs2.43122a93.svg"},function(t,e,s){t.exports=s.p+"static/media/queen_of_diamonds.b8357abb.svg"},function(t,e,s){t.exports=s.p+"static/media/queen_of_diamonds2.cdc326c0.svg"},function(t,e,s){t.exports=s.p+"static/media/queen_of_hearts.7a78a2cb.svg"},function(t,e,s){t.exports=s.p+"static/media/queen_of_hearts2.c439a881.svg"},function(t,e,s){t.exports=s.p+"static/media/queen_of_spades.410715a5.svg"},function(t,e,s){t.exports=s.p+"static/media/queen_of_spades2.58d77ea5.svg"},function(t,e,s){t.exports=s.p+"static/media/red_joker.1ba0f353.svg"},function(t,e,s){},function(t,e,s){},,,function(t,e){},,function(t,e){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){},,function(t,e){},,,,,,,,,,,,,,,,,,,,,,,function(t,e){},function(t,e){},,function(t,e){},,function(t,e){},,,,,,,,function(t,e){},,function(t,e){},,,function(t,e,s){"use strict";s.r(e);var a,i=s(0),n=s.n(i),o=s(78),c=s.n(o),r=(s(86),s(87),s(6)),d=s(8),f=s(23),u=s(22);!function(t){t.hearts="hearts",t.spades="spades",t.clubs="clubs",t.diamonds="diamonds"}(a||(a={}));var p=s(39),_=s.n(p),l=(s(88),s(89)),v=l.keys().reduce((function(t,e){return t[e]=l(e),t}),{}),h=function(){function t(){Object(r.a)(this,t)}return Object(d.a)(t,[{key:"valueToFaceCard",value:function(t){switch(t){case 1:return"ace";case 11:return"jack";case 12:return"queen";case 13:return"king";default:return t.toString()}}},{key:"getImage",value:function(t,e){var s=[11,12,13].indexOf(t)>=0?"2":"",a="./"+this.valueToFaceCard(t)+"_of_"+e+s+".svg";return v[a]}}]),t}(),g=s(79),m=s.n(g),b=function(t){Object(f.a)(s,t);var e=Object(u.a)(s);function s(t,i){var n;return Object(r.a)(this,s),(n=e.call(this,t)).suit=a.spades,n.value=1,n.backSrc=_.a,n.cardImages=void 0,n.cardImages=new h,n}return Object(d.a)(s,[{key:"render",value:function(){var t=m()("flip-card",{"flip-it":this.props.cardState.faceUp});return n.a.createElement("div",{className:"card-container"},n.a.createElement("div",{className:t,onClick:this.props.cardState.removed?function(){}:this.props.onClick},n.a.createElement("div",{className:"flip-card-inner"},n.a.createElement("div",{className:"flip-card-front"},n.a.createElement("img",{src:this.backSrc,alt:"",className:"flip-card-img"})),n.a.createElement("div",{className:"flip-card-back"},n.a.createElement("img",{src:this.cardImages.getImage(this.props.cardState.value,this.props.cardState.suit),alt:"",className:"flip-card-img"})))))}}]),s}(n.a.Component),k=(s(157),function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.spades,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(r.a)(this,t),this.value=1,this.suit=a.spades,this.faceUp=void 0,this.removed=void 0,this.value=e,this.suit=s,this.faceUp=i,this.removed=n}),y=function(){function t(e){Object(r.a)(this,t),this.players=[],this.turn=0,this.pickedCard=new k,this.wasPicked=!1,this.created=Date.now(),this.players=e}return Object(d.a)(t,[{key:"addPlayer",value:function(t){this.players.push(t),this.players.sort((function(t,e){return t.created-e.created}))}},{key:"pickCard",value:function(t){this.pickedCard=t,this.wasPicked=!0}},{key:"matchCard",value:function(t){return this.wasPicked?t.value===this.pickedCard.value&&t.suit!==this.pickedCard.suit?(this.wasPicked=!1,this.players[this.turn].score+=2,!0):(this.endTurn(),!1):(this.wasPicked=!1,this.endTurn(),!1)}},{key:"getCurrentTurnPlayer",value:function(){return this.players[this.turn]}},{key:"endTurn",value:function(){this.wasPicked=!1,this.turn=(this.turn+1)%this.players.length}}]),t}(),x=function(){function t(e){Object(r.a)(this,t),this.name="playerName",this.score=0,this.created=Date.now(),this.lastPickedCard=-1,this.name=e}return Object(d.a)(t,[{key:"equals",value:function(t){return this.name===t.name&&this.score===t.score&&this.created===t.created}}]),t}(),C=(s(158),function(t){Object(f.a)(s,t);var e=Object(u.a)(s);function s(){return Object(r.a)(this,s),e.apply(this,arguments)}return Object(d.a)(s,[{key:"render",value:function(){return n.a.createElement("div",{className:"scores"},this.props.players.map((function(t){return n.a.createElement("h5",{className:"score",key:t.created},t.name,": ",t.score)})))}}]),s}(n.a.Component)),j=s(80),S=function t(e){Object(r.a)(this,t),this.baseTopic=void 0,this.joinGame=void 0,this.oldPlayers=void 0,this.pickCard=void 0,this.shuffle=void 0,this.baseTopic=e,this.joinGame=e+"/joinGame",this.oldPlayers=e+"/oldPlayers",this.pickCard=e+"/pickCard",this.shuffle=e+"/shuffle"},O=function(t){Object(f.a)(s,t);var e=Object(u.a)(s);function s(t){var i;Object(r.a)(this,s),(i=e.call(this,t)).cards=[],i.round=void 0,i.flippedCards=[-1,-1],i.player=void 0,i.incorrectFlip=!1,i.client=void 0,i.topic=void 0,i.handleNewPlayer=function(t,e){console.log("handle new player"),i.round.players=[i.player],i.client.publish(i.topic.oldPlayers,JSON.stringify(i.player))},i.handleOldPlayers=function(t,e){var s=JSON.parse(e),a=new x(s.name);a.created=s.created,a.score=s.score;for(var n=0;n<i.round.players.length;n++)if(i.round.players[n].equals(a))return;i.round.addPlayer(a),console.log("setting state"),i.setState({})},i.handlePickCard=function(t,e){var s=JSON.parse(e);i.player.equals(s)||i.pickCard(s.lastPickedCard,!0,s)},i.handleShuffle=function(t,e){var s=JSON.parse(e);i.setState({cardStates:s})},i.shuffle=function(){i.state.cardStates.sort((function(){return Math.random()-.5})),i.setState({cardStates:i.state.cardStates}),i.client.publish(i.topic.shuffle,JSON.stringify(i.state.cardStates))},i.player=new x("Daniel"),i.round=new y([i.player]),i.state={cards:i.cards,cardStates:[],playerTurn:0};for(var n=[a.spades,a.diamonds,a.clubs,a.hearts],o=1;o<=13;o++)for(var c in n)i.state.cardStates.push(new k(o,n[c],!1));return i.topic=new S("matchesgame/1234"),i.client=Object(j.connect)("ws://test.mosquitto.org",{port:8081}),i}return Object(d.a)(s,[{key:"componentDidMount",value:function(){this.connectMqtt(this.topic.baseTopic),this.client.publish(this.topic.joinGame,JSON.stringify(this.player))}},{key:"connectMqtt",value:function(t){var e=this;this.client.subscribe(this.topic.baseTopic),this.client.subscribe(this.topic.joinGame),this.client.subscribe(this.topic.oldPlayers),this.client.subscribe(this.topic.pickCard),this.client.subscribe(this.topic.shuffle),this.client.on("message",(function(t,s){switch(t){case e.topic.joinGame:e.handleNewPlayer(t,s.toString());break;case e.topic.oldPlayers:e.handleOldPlayers(t,s.toString());break;case e.topic.pickCard:e.handlePickCard(t,s.toString());break;case e.topic.shuffle:e.handleShuffle(t,s.toString())}}))}},{key:"getCardById",value:function(t){return this.state.cardStates[t]}},{key:"pickCard",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.player;console.log("picking card: "+t);var a=s;e&&this.player.created===a.created||(a.lastPickedCard=t,this.player.created===a.created&&this.client.publish(this.topic.pickCard,JSON.stringify(a)),this.incorrectFlip?(this.flipCard(this.flippedCards[0]),this.flipCard(this.flippedCards[1]),this.incorrectFlip=!1):this.round.wasPicked?(this.flipCard(t),this.round.matchCard(this.getCardById(t))?(this.getCardById(t).removed=!0,this.getCardById(this.flippedCards[0]).removed=!0):(this.incorrectFlip=!0,this.flippedCards[1]=t)):(this.flippedCards[0]=t,this.flipCard(t),this.round.pickCard(this.getCardById(t))),this.round.turn!==this.state.playerTurn&&this.setState({playerTurn:this.round.turn}))}},{key:"flipCard",value:function(t){var e=!this.state.cardStates[t].faceUp;this.state.cardStates[t].faceUp=e,this.setState({cardStates:this.state.cardStates})}},{key:"render",value:function(){for(var t,e,s,a=this,i=function(t){a.state.cards[t]=n.a.createElement(b,{key:t,cardState:a.state.cardStates[t],onClick:function(){a.pickCard(t)}})},o=0;o<this.state.cardStates.length;o++)i(o);return n.a.createElement("div",null,n.a.createElement("h3",null,null===(t=this.round.getCurrentTurnPlayer())||void 0===t?void 0:t.name," turn ",(null===(e=this.round.getCurrentTurnPlayer())||void 0===e?void 0:e.created)===(null===(s=this.player)||void 0===s?void 0:s.created)?"(you)":""),n.a.createElement(C,{players:this.round.players}),n.a.createElement("button",{onClick:this.shuffle},"Shuffle"),n.a.createElement("div",{className:"card-table"},this.state.cards))}}]),s}(n.a.Component);var w=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(O,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}]),[[81,1,2]]]);
//# sourceMappingURL=main.3e101442.chunk.js.map